<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/06/15/hello-world/" class="article-date">
  <time datetime="2017-06-15T01:25:50.389Z" itemprop="datePublished">2017-06-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/06/15/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/06/15/hello-world/" data-id="cj3xtejgk00084se99n9p2f7e" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-js-中continue、break、return的区别" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/08/js-中continue、break、return的区别/" class="article-date">
  <time datetime="2017-02-08T10:27:00.000Z" itemprop="datePublished">2017-02-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/08/js-中continue、break、return的区别/">js 中continue、break、return的区别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>js 中continue、break、return的区别</p>
<ul>
<li>continue:结束本次循环，循环变量继续递增或递减，开始下次循环</li>
<li></li>
<li>break:结束循环，执行循环后面的代码(如果有的话)</li>
<li></li>
<li>return:结束函数的执行，return后面的所有代码都不再执行</li>
</ul>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="function"><span class="keyword">function</span> <span class="title">inqiu</span>(<span class="params"></span>) </span>&#123;</div><div class="line">     <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt;= <span class="number">10</span>; i++) &#123;</div><div class="line">                <span class="keyword">if</span> (i == <span class="number">3</span>) &#123;</div><div class="line">                    <span class="comment">//test1.continue;</span></div><div class="line">                    <span class="comment">//test2.break;</span></div><div class="line">                    <span class="comment">//test3</span></div><div class="line">					<span class="keyword">return</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="built_in">document</span>.write(i);</div><div class="line">                <span class="built_in">document</span>.write(<span class="string">'&lt;/br&gt;'</span>);</div><div class="line">      &#125;</div><div class="line">      alert(<span class="string">'inqiu() End'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>test1.以次打印出：<code>1  2  4  5  6  7  8  9  10</code> 以及执行<code>alert(&#39;inqiu() End&#39;);</code></p>
<p>test2.以次打印出：<code>1  2</code></p>
<p>test3.以次打印出：<code>1  2</code></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/02/08/js-中continue、break、return的区别/" data-id="cj3xtejgu000g4se9kl6vu3vs" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-js查找字符串中出现最多的以及个数" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/06/js查找字符串中出现最多的以及个数/" class="article-date">
  <time datetime="2017-02-06T04:00:00.000Z" itemprop="datePublished">2017-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/06/js查找字符串中出现最多的以及个数/">js查找字符串中出现最多的以及个数</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>一个非常常见的前端面试题，后端也应该会经常遇到吧。</p>
<p>在这里，总结下，希望正在找工作的朋友们会用到。</p>
<p>如果有更好的方法，也请下边留言。</p>
<p>如：找出下面字符串中出现最多的是哪一个，以及出现了几次。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> str = <span class="string">'fdgdfgsdfdgtertreuujjktyitidssadrt'</span>;</div><div class="line"><span class="comment">/*</span></div><div class="line"> * 解法一：字符串方式</div><div class="line"> * */</div><div class="line">(<span class="function"><span class="keyword">function</span> (<span class="params">str</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> obj = &#123;&#125;;</div><div class="line">      <span class="keyword">var</span> num = <span class="number">0</span>;</div><div class="line">      <span class="keyword">var</span> value = <span class="string">''</span>;</div><div class="line">      <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; str.length; i++ ) &#123;</div><div class="line">          <span class="comment">// 如果obj中不存在某个字符属性，就把它添加进去</span></div><div class="line">          <span class="keyword">if</span> (!obj[str[i]]) &#123;</div><div class="line">              obj[str[i]] = [];</div><div class="line">          &#125;</div><div class="line">          <span class="comment">// 把值一一填入到obj[a[i]]中</span></div><div class="line">          obj[str[i]].push(str[i]);</div><div class="line">      &#125;</div><div class="line">      <span class="comment">// 找出最多项的那个</span></div><div class="line">      <span class="keyword">for</span> ( <span class="keyword">var</span> i <span class="keyword">in</span> obj ) &#123;</div><div class="line">           <span class="keyword">if</span> (num &lt; obj[i].length) &#123;</div><div class="line">                num = obj[i].length;</div><div class="line">                value = i;</div><div class="line">           &#125;</div><div class="line">       &#125;</div><div class="line">        <span class="keyword">var</span> tips = <span class="string">'字符最多的是：'</span> + value + <span class="string">'，出现了：'</span> + num + <span class="string">'次'</span>;</div><div class="line">        alert(tips);</div><div class="line">&#125;)(str);</div></pre></td></tr></table></figure>
<p>2016-02-06日 inqiu.com更新<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line"> * 解法二：正则方式</div><div class="line"> * */</div><div class="line"><span class="keyword">var</span> str=<span class="string">"vbbbbhybbfhbbgbbb"</span>;</div><div class="line"><span class="keyword">var</span> arr=str.split(<span class="string">""</span>);</div><div class="line">str=arr.sort().join(<span class="string">""</span>);</div><div class="line"><span class="keyword">var</span> value=<span class="string">""</span>; <span class="comment">//存放出现最多的字符</span></div><div class="line"><span class="keyword">var</span> index=<span class="number">0</span>; <span class="comment">//存放次数</span></div><div class="line"><span class="keyword">var</span> re=<span class="regexp">/(\w)\1+/g</span>;</div><div class="line">str.replace(re,<span class="function"><span class="keyword">function</span>(<span class="params">$<span class="number">0</span>,$<span class="number">1</span></span>)</span>&#123; <span class="comment">//$0代表整体，$1代表第一个子项</span></div><div class="line"> <span class="keyword">if</span>(index&lt;$<span class="number">0.</span>length)&#123; <span class="comment">//$0:每一组重复的元素</span></div><div class="line">  index=$<span class="number">0.</span>length;</div><div class="line">  value=$<span class="number">1</span>;</div><div class="line"> &#125;</div><div class="line">&#125;)</div><div class="line">alert(<span class="string">'出现最多的字符是：'</span>+value+<span class="string">',出现次数是'</span>+index);</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/02/06/js查找字符串中出现最多的以及个数/" data-id="cj3xtejgx000i4se9lo3b4oi5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript基本数据类型和引用类型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/JavaScript基本数据类型和引用类型/" class="article-date">
  <time datetime="2017-01-23T06:44:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/JavaScript基本数据类型和引用类型/">JavaScript基本数据类型和引用类型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><strong>js中的变量分为两种类型：</strong></p>
<ol>
<li>基本数据类型</li>
<li>引用数据类型</li>
</ol>
<p>JS基本数据类型的变量存放的是基本类型数据的实际值；而引用数据类型的变量保存对它的引用，即指针。</p>
<p>说白了就是：<strong>基本数据类型传的是数值，引用类型传的是变量堆内存的地址</strong></p>
<p>这句在下边最后的几个例子当中尤为重要。</p>
<p>JS基本数据类型：null undefined number boolean</p>
<p>string比较特殊</p>
<p>引用数据类型：function object array</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 1.基本数据类型是复制关系</div><div class="line">* 一个值的改变不会影响到另一个值的变化</div><div class="line">* */</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="number">5</span>;</div><div class="line"><span class="keyword">var</span> b = a;</div><div class="line">b += <span class="number">3</span>;</div><div class="line">alert(b);   <span class="comment">// 8</span></div><div class="line">alert(a);   <span class="comment">// 5</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 2.对象和函数是引用关系</div><div class="line">* 就是说，两个值使用同一个对象或函数，</div><div class="line">* 其中一个改变了函数，另一个也会发生变化</div><div class="line">* */</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="keyword">var</span> b = a;</div><div class="line">b.push(<span class="number">4</span>);</div><div class="line">alert(b); <span class="comment">//1,2,3,4</span></div><div class="line">alert(a); <span class="comment">//1,2,3,4</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line"><span class="comment">// 此时的a和b指向同一个数组</span></div><div class="line"><span class="keyword">var</span> b = a;</div><div class="line"><span class="comment">// 这里b重新指向了一个新数组，与之前的a指向的数组断开了关系</span></div><div class="line">b = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</div><div class="line">alert(b); <span class="comment">//1,2,3,4</span></div><div class="line">alert(a); <span class="comment">//1,2,3</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 思考？</div><div class="line">* 像对象引用这个情况，两个共享一份内存，这不是我们想要的</div><div class="line">* 我们要的是复制一份新的数据到新内存中去，这样两个就不会相关了</div><div class="line">* 因此我们需要拷贝</div><div class="line">* */</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 3.浅拷贝</div><div class="line">* */</div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span> : <span class="number">10</span> &#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> newObj = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> attr <span class="keyword">in</span> obj ) &#123;</div><div class="line">        newObj[attr] = obj[attr];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newObj;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj2 = copy(obj);</div><div class="line">obj2.a = <span class="number">20</span>;</div><div class="line">alert(obj2.a); <span class="comment">//20</span></div><div class="line">alert(obj.a);  <span class="comment">//10</span></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 这样的化，当obj2.a的值发生了变化，obj.a的值不会变</div><div class="line">*</div><div class="line">* 但是，这仅仅是浅拷贝</div><div class="line">* 浅拷贝仅仅拷贝的是基本数据类型，对于对象和函数就会出问题</div><div class="line">* 对于对象引用拷贝的值，两个对象还是指向同一个内存，两者相关</div><div class="line">* */</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span> : &#123; <span class="attr">b</span> : <span class="number">10</span> &#125; &#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> newObj = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> attr <span class="keyword">in</span> obj ) &#123;</div><div class="line">        newObj[attr] = obj[attr];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newObj;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj2 = copy(obj);</div><div class="line">obj2.a.b = <span class="number">20</span>;</div><div class="line">alert(obj2.a.b); <span class="comment">//20</span></div><div class="line">alert(obj.a.b);  <span class="comment">//20</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line">* 对于上述的情况，浅拷贝并不能解决对象引用的问题</div><div class="line">* 这是我们应该编写一个深拷贝的函数</div><div class="line">* 这里用到了递归：自己(函数)调用自己</div><div class="line">* */</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span> : &#123; <span class="attr">b</span> : <span class="number">10</span> &#125; &#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="comment">// 最后一次判断终止条件，开始归的动作</span></div><div class="line">    <span class="comment">// 如果obj为基本数据类型时，就直接返回，只需要深拷贝</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> obj !== <span class="string">'function'</span>) &#123;</div><div class="line">        <span class="keyword">return</span> obj;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> newObj = &#123;&#125;;</div><div class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> attr <span class="keyword">in</span> obj ) &#123;</div><div class="line">        newObj[attr] = <span class="built_in">arguments</span>.callee(obj[attr]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> newObj;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> obj2 = deepCopy(obj);</div><div class="line">obj2.a.b = <span class="number">20</span>;</div><div class="line">alert(obj2.a.b); <span class="comment">//20</span></div><div class="line">alert(obj.a.b);  <span class="comment">//10</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/01/23/JavaScript基本数据类型和引用类型/" data-id="cj3xtejgd00044se947wkxt4y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JavaScript作用域、以及数据类型" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/JavaScript作用域、以及数据类型/" class="article-date">
  <time datetime="2017-01-23T03:00:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/JavaScript作用域、以及数据类型/">JavaScript作用域、以及数据类型</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>javascript作用域</p>
</blockquote>
<p>js中的变量分为两种类型：</p>
<ol>
<li>基本数据类型</li>
<li>引用数据类型</li>
</ol>
<p>JS基本数据类型的变量存放的是基本类型数据的实际值；而引用数据类型的变量保存对它的引用，即指针。</p>
<p>说白了就是：<strong>基本数据类型传的是数值，引用类型传的是变量堆内存的地址</strong></p>
<p>这句在下边最后的几个例子当中尤为重要。</p>
<p>JS基本数据类型：null undefined number boolean</p>
<p>string比较特殊</p>
<p>引用数据类型：function object array</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*</span></div><div class="line">    * 1.全局变量与局部变量</div><div class="line">    * 外层变量可以在内层调用（全局），内层变量不能在外层调用（局部）</div><div class="line">    * */</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// 外部变量可以在内部调用</span></div><div class="line">        alert(a);</div><div class="line">    &#125;)();</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// 内部变量不能在外部调用</span></div><div class="line">        <span class="keyword">var</span> a = <span class="number">2</span>;</div><div class="line">    &#125;</div><div class="line">    alert(a);   <span class="comment">// 报错</span></div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line">    * 下面举个例子：</div><div class="line">    * 函数调用只是回到函数定义的地方，调用一下函数</div><div class="line">    * 这里在bbb函数中，调用aaa函数，</div><div class="line">    * 这时的aaa函数并不是被放入bbb函数中，而是在原定义的地方</div><div class="line">    * 这是的aaa中没有变量a，所以去访问全局变量中的a</div><div class="line">    * */</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">aaa</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        alert(a);</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">bbb</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> a = <span class="number">20</span>;</div><div class="line">        aaa();</div><div class="line">    &#125;</div><div class="line">    bbb();  <span class="comment">// 10</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line">    * 2.当var不加的时候，会自动变成全局变量</div><div class="line">    * 在全局环境中，不加var和加var效果一样，都是全局变量</div><div class="line">    * 在局域环境中，加var会被定义为局部变量，不加var会被定义为全局变量</div><div class="line">    * */</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> a = <span class="number">10</span>; <span class="comment">// 外部访问不到</span></div><div class="line">        b = <span class="number">10</span>;     <span class="comment">// 相当于全局变量</span></div><div class="line">        <span class="comment">// 上面相当于：var a = b = 10;</span></div><div class="line">    &#125;</div><div class="line">    test();</div><div class="line">    alert(b);   <span class="comment">// 10</span></div><div class="line">    alert(a);   <span class="comment">// 报错</span></div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line">    * 3.变量查找按照就近原则去查找</div><div class="line">    * var定义的变量，当就近查找没有找到就去外层查找</div><div class="line">    * */</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> a = <span class="number">20</span>;</div><div class="line">        <span class="comment">// a在匿名函数中var定义了，所以找到为20</span></div><div class="line">        alert(a);   <span class="comment">// 20</span></div><div class="line">    &#125;)();</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        a = <span class="number">20</span>;   <span class="comment">// 相当于全局变量，将外部的var a = 20;</span></div><div class="line">        <span class="comment">// 在匿名函数中没有找到var定义的a，然后去外层去查找</span></div><div class="line">        <span class="comment">// 外部查找到了，var a = 10 = 20;</span></div><div class="line">        alert(a);   <span class="comment">// 20</span></div><div class="line">    &#125;)();</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// 在匿名函数中没有找到var定义的a，然后去外层去查找</span></div><div class="line">        <span class="comment">// 外部查找到了，var a = 10</span></div><div class="line">        alert(a);   <span class="comment">// 10</span></div><div class="line">        a = <span class="number">20</span>;</div><div class="line">    &#125;)();</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// 在匿名函数中找到var定义的a，</span></div><div class="line">        <span class="comment">// 这里的var a = 20,存在变量提升,</span></div><div class="line">        <span class="comment">// 在执行alert(a)之前，变量提示有var a;</span></div><div class="line">        <span class="comment">// 但是a没有值，所有返回undefined</span></div><div class="line">        alert(a);   <span class="comment">// undefined</span></div><div class="line">        <span class="keyword">var</span> a = <span class="number">20</span>;</div><div class="line"></div><div class="line">        <span class="comment">// 在变量提升的情况下，相当于下面：</span></div><div class="line">        <span class="comment">// var a;</span></div><div class="line">        <span class="comment">// alert(a);</span></div><div class="line">        <span class="comment">// a = 20;</span></div><div class="line">    &#125;)();</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="comment">// 执行bbb,bbb中的a=20,但是与匿名函数和全局变量a无关</span></div><div class="line">        bbb();</div><div class="line">        <span class="comment">// 在匿名函数中查找var定义的a,发现没有</span></div><div class="line">        <span class="comment">// 继续在外层中查找，发现了 var a = 10;</span></div><div class="line">        alert(a);   <span class="comment">// 10</span></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bbb</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> a = <span class="number">20</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;)();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">        bbb();</div><div class="line">        <span class="comment">// 在匿名函数中查找var定义的a,发现没有</span></div><div class="line">        <span class="comment">// 继续在外层中查找，发现了 var a = 10 = 20;</span></div><div class="line">        alert(a);   <span class="comment">// 20</span></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bbb</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="comment">// 没有var定义，所有为全局变量，外面的全局变量 var a = 10 = 20;</span></div><div class="line">            a = <span class="number">20</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;)();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/*</span></div><div class="line">    * 当参数与局部变量重名时，优先级等同</div><div class="line">    * */</div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</div><div class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</div><div class="line">        <span class="comment">// 这里的参数a是基本数据类型，按值传参的</span></div><div class="line">        <span class="comment">// 参数a相当于在匿名函数内部重新定义了一个a，</span></div><div class="line">        <span class="comment">// 且与外层的a不相关</span></div><div class="line">        a += <span class="number">3</span>;</div><div class="line">    &#125;)(a);</div><div class="line">    alert(a);   <span class="comment">// 10</span></div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</div><div class="line">        <span class="comment">// 这里的参数a是引用类型，按引用传参的</span></div><div class="line">        <span class="comment">// 参数a相当于在匿名函数内部重新定义了一个a，</span></div><div class="line">        <span class="comment">// 但是这个a是外层a的一个别名，它们引用了同一个地址</span></div><div class="line">        <span class="comment">// 所以内部a添加值，外部a可以访问到</span></div><div class="line">        a.push(<span class="number">4</span>);</div><div class="line">    &#125;)(a);</div><div class="line">    alert(a);   <span class="comment">// [1,2,3,4]</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">var</span> a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</div><div class="line">    (<span class="function"><span class="keyword">function</span> (<span class="params">a</span>) </span>&#123;</div><div class="line">        <span class="comment">// 这里的参数a是引用类型，按引用传参的</span></div><div class="line">        <span class="comment">// 参数a相当于在匿名函数内部重新定义了一个a，</span></div><div class="line">        <span class="comment">// 但是这个a是外层a的一个别名，它们引用了同一个地址</span></div><div class="line">        <span class="comment">// 所以内部a添加值，外部a可以访问到</span></div><div class="line"></div><div class="line">        <span class="comment">// 但是，这里的a又重新赋值了新的数组，断开了与外层的关系</span></div><div class="line">        a = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];</div><div class="line">    &#125;)(a);</div><div class="line">    alert(a);   <span class="comment">// [1,2,3]</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/01/23/JavaScript作用域、以及数据类型/" data-id="cj3xtejgb00034se96x7hl32x" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-javascript闭包，闭包的优点与弊端" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/23/javascript闭包，闭包的优点与弊端/" class="article-date">
  <time datetime="2017-01-23T01:30:00.000Z" itemprop="datePublished">2017-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/23/javascript闭包，闭包的优点与弊端/">javascript闭包，闭包的优点与弊端</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>JavaScript闭包</p>
</blockquote>
<p>JavaScript闭包,前端必然会遇到的一个技术点</p>
<p>那么问题来了,什么是闭包?其存在必定有其原有</p>
<ul>
<li>为什么要用闭包？</li>
<li>它的优点是什么？</li>
<li>经常会用在那些场景？</li>
<li>用了它之后,又有弊端有哪些？</li>
</ul>
<p>下边我们以此来通俗易懂的来解答这个问题</p>
<p><strong>什么是闭包？</strong></p>
<p>就是函数嵌套函数，内部函数可以访问外部函数的参数和变量，并且外部函数的变量和参数不会被垃圾回收机制所收回</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fn = (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</div><div class="line">     <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">         i++;</div><div class="line">         alert(i);</div><div class="line">     &#125;;</div><div class="line">&#125;)(<span class="number">1</span>);</div><div class="line">fn();    <span class="comment">// 2</span></div><div class="line">fn();    <span class="comment">// 3</span></div></pre></td></tr></table></figure>
<p><strong>闭包的好处？</strong></p>
<pre><code>1.使得变量长期处于内存
2.避免了全局变量的污染
3.将变量成员私有化
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fn = (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> i = <span class="number">1</span>;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">bbb</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            i++;</div><div class="line">            alert(i);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">ccc</span>(<span class="params"></span>) </span>&#123;</div><div class="line">            i++;</div><div class="line">            alert(i);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> &#123;</div><div class="line">            <span class="attr">bbb</span> : bbb,</div><div class="line">            <span class="attr">ccc</span> : ccc,</div><div class="line">        &#125;</div><div class="line">&#125;)();</div><div class="line">fn.bbb();</div><div class="line"> fn.ccc();</div></pre></td></tr></table></figure>
<p><strong>闭包的场景？用法？</strong></p>
<pre><code>1.模块化代码
2.在循环中直接找出对应元素的索引
3. ...
</code></pre><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"> <span class="comment">/*</span></div><div class="line">    * 引子：</div><div class="line">    * 不使用闭包的情况下，看看索引</div><div class="line">    * 你会发现，全部为4，</div><div class="line">    * 这是因为，for循环完毕了，才进行点击事件</div><div class="line">    * */</div><div class="line"></div><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> oUl = <span class="built_in">document</span>.getElementById(<span class="string">'ul1'</span>);</div><div class="line">        <span class="keyword">var</span> aLi = oUl.getElementsByTagName(<span class="string">'li'</span>);</div><div class="line">        <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; aLi.length; i++ ) &#123;</div><div class="line">            aLi[i].onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                alert(i);   <span class="comment">// 全部为4</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"> <span class="comment">/*</span></div><div class="line">    * 我们通过闭包来传参，以达到找到对应元素索引</div><div class="line">    *</div><div class="line">    * */</div><div class="line"></div><div class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">var</span> oUl = <span class="built_in">document</span>.getElementById(<span class="string">'ul1'</span>);</div><div class="line">        <span class="keyword">var</span> aLi = oUl.getElementsByTagName(<span class="string">'li'</span>);</div><div class="line">        <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; aLi.length; i++ ) &#123;</div><div class="line">            aLi[i].onclick = (<span class="function"><span class="keyword">function</span> (<span class="params">i</span>) </span>&#123;</div><div class="line">                <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                    alert(i);</div><div class="line">                &#125;</div><div class="line">            &#125;)(i);</div><div class="line">        &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>闭包的弊端</strong></p>
<p>闭包的弊端，最为著名的应该是内存泄漏了吧，因还未准备充分，那么请等待更新。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/01/23/javascript闭包，闭包的优点与弊端/" data-id="cj3xtejgr000b4se9oylchdzt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-YY游戏云平台在AngularJS上的实践总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/06/YY游戏云平台在AngularJS上的实践总结/" class="article-date">
  <time datetime="2016-12-06T10:19:00.000Z" itemprop="datePublished">2016-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/06/YY游戏云平台在AngularJS上的实践总结/">YY游戏云平台在AngularJS上的实践总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>导语</p>
</blockquote>
<p>云平台控制台，是一个典型的管控CRUD系统，用于管理各种IaaS资源。</p>
<p>为了使前端能达到仿客户端体验，同时保障代码架构清晰规范，易维护，最终多玩YY选择了AngularJS（1.x）作为云控制台的前端框架。</p>
<p>本文主要围绕AngularJS（1.x），介绍多玩YY在开发控制台过程中的点点滴滴。</p>
<blockquote>
<p>为什么选择AngularJS</p>
</blockquote>
<p>轻松构建单页面应用</p>
<p>可以说，这是我们最终选择AngularJS的重要原因，如果你希望构建一个结构清晰、可维护、开发效率高、体验好的单页应用，AngularJS是相当不错的框架。</p>
<p>单页面应用的魅力</p>
<p><strong>什么是单页面应用？</strong></p>
<p>单页应用，指一种基于Web的应用或者网站，页面永远都是局部更新元素，而不是整页刷新，给用户的感觉就像整个网站都是一个页面。</p>
<p>当用户点击某个菜单或者按键时，不会跳转到其他页面，前端会从后端获取对应页面的数据而不是HTML，之后在页面中需要更新内容的地方，局部动态刷新，而如果是传统的多页网站，当用户访问不同的页面时，服务器会直接返回一个HTML，然后浏览器负责将这个HTML展现给用户。目前，</p>
<p>大部分云控制台，都是单页应用架构，单页应用能带来一种更近似客户端，而不是网页的体验。</p>
<p>单页面应用网站，在体验方面，具有如下优点：</p>
<p>做“页面跳转”时，永远都是局部动态刷新，用户不会感觉整个屏幕闪了一下，而仅仅是需要变化的区域做了局部刷新。</p>
<p>例如两个不同的页面，假设页面元素都是一样的，只是元素中的文字不一样（例如每个页面都有一个面包屑，一排按钮及一个表格，这几个元素的布局也是一样的），当用户跳转到另外一个页面时，会看到整个页面并没有重新渲染，只是文字发生了变化。简单地说，这有点类似使用App，永远都是局部发生变化，你见过哪个App，当点击到不同的功能视图时，整个屏幕会白屏闪一下的么？</p>
<p>URL可收藏，可回退。</p>
<p>如果浏览器的URL一直不变，那还不能称为真正的单页应用。不同的功能，不同的资源页面，对应的URL是不一样的。</p>
<p>当用户跳转到另外的功能时，会发现URL会变成对应的值；通过回退键，也可以回到之前浏览的页面。</p>
<p>这个特性有什么用呢？如果URL不会随着功能而变化，当用户刷新当前页面时，就会回到之前的默认页面，而不是预期的当前功能页面，同样的，URL也不具备可收藏性，因为点开之前收藏的URL，永远都是网站的默认页面。这对一些强交互的管控系统来说，体验不好。</p>
<p>功能切换时快速流畅。快速流畅主要因为两个原因：</p>
<pre><code>一是页面都是局部刷新，从用户感官来说更快

二是和后台通信的内容，都是数据，而不是页面模板，请求量更少；而传统网站，在访问不同页面时，服务端返回的是HTML，体积更大，而且还需要一直重复加载JavaScript、CSS文件。
</code></pre><p>因为网站的单页化，可以更好地使用全局类的交互（做页面切换时，需要一直保持不变的交互）。</p>
<p>例如，页面上需要显示某次耗时操作的进度，例如上传文件进度，耗时操作的当前状态等，你可以在页面最右侧固定显示进度。当用户访问单页应用时，他会明白，当点击其他模块时，这个右侧的通知栏不会消失，会固定显示。</p>
<p>而如果是多页网站，用户则会困惑，担心自己跳转到其他页面后，进度通知就会消失。</p>
<p>AngularJS是开发单页应用的利器</p>
<p>单页面应用对于代码分层，结构清晰有更高的要求，而AngularJS是一个MVVM框架，其自身的约定，减少了我们写出“一锅粥”代码的可能性（在下面讨论“编写更易维护的代码”时会详述）。</p>
<p>AngularJS的著名第三方组件UI-Router，是一个控制页面路由的组件，它支持我们快速搭建单页应用（AngularJS本身的路由功能也可以，但功能会稍微弱一些）。</p>
<p>AngularJS的检查更新机制，使页面刷新时更加快速自然。 当数据“可能”发生变化时，AngularJS会检查出所有变化的元素，再“一次性”刷新所有变化的UI元素。</p>
<p><strong>编写更易维护的代码</strong></p>
<p>很多人经常会抱怨，不同水平的人凑在一起写JavaScript，到最后项目经常就是一锅粥，同一个JavaScript文件里面，各种各样的逻辑都混在一起，要增删功能，简直是恶梦。无规矩不成方圆。</p>
<p>作为框架，AngularJS无疑能大大改善这种状况，使得项目整体的分层明了，职责清晰。</p>
<p>在笔者看来，AngularJS能够帮助我们编写更易维护的代码，</p>
<pre><code>一是因为其“关注点分离”的理念

二是因为其强大的特性为项目节省了不少代码量，从而降低程序员犯错的概率。
</code></pre><p><strong>关注点分离</strong></p>
<p>关注点分离是AngularJS的一大设计哲学。</p>
<p>所谓关注点分离，指的是各个逻辑层职责清晰明确。</p>
<p>例如，当你需要修改甚至替换展现层时，无需关注业务层是怎么实现的。</p>
<p>在AngularJS中，服务层（Ajax请求）- 业务层（Controller）- 展现层（HTML 模板）- 交互层（animation）这些都有对应的基础组件。</p>
<p>不同组件职责不同，也很难将本属于B组件的职责放到A组件上去实现。</p>
<p>举几个例子：</p>
<p>HTML及Controller需要协同工作，但职责分明。视图、交互层面的逻辑，例如展示隐藏某些元素，是HTML模板的职责，Controller只能用于数据初始化。</p>
<p>如果你反其道而行，想在Controller中做HTML模板做的事情，将会非常别扭。这一点非常重要，传统的JavaScript代码，经常会出现的情况，就是JavaScript里面会有大量DOM操作的逻辑，同时还有大量数据操作相关的逻辑，这些逻辑耦合到一起，当需要单独重构数据层或者视图层时（例如项目UI改版），都会捉襟见肘，同时，由于JavaScript代码量的迅速膨胀，维护起来也会很麻烦。</p>
<p>你无法将后台通信逻辑放到Controller中实现，而要放到Factory中。</p>
<p>后台通信逻辑，一般要做成公用的。而由于Controller之间是不能相互调用的，所以你也不可能将后台通信逻辑放到其中一个Controller，然后其他Controller来调用这个Controller暴露的接口。</p>
<p>唯一的办法，就是将后台通信逻辑放到Factory或者Service中。</p>
<p>Filter及Directive看似都可以用于数据转换，但实则不同。由于Filter只能做数据格式化，不支持引入模板，所以公用的UI交互，涉及到DOM元素或者需要引入HTML模板时时，也只能通过Directive来实现。</p>
<p>综上所述，AngularJS项目，其展现层、交互层的逻辑，都是在HTML或者指令中，服务层（后台通信），只适合出现在Factory（或者Service）中，而业务层则由Controller来负责。这样每层的逻辑都是轻薄的，而不是纠结在一起。 如果你只是要优化展示逻辑，那改改HTML就可以了，不用去管Controller是怎么写的。这</p>
<p>一点我们有亲身体会。项目开发过程中，我们重构了视觉效果，所有的HTML都要重写。但在重构时，我们的Controller、后台通信（Service）、Filter基本都不用改，只要改HTML就行了。而如果项目是用jQuery写的，显然不可能做到，你需要重新为新的HTML增加一些可供jQuery选择器使用的class或id，然后需要在JavaScript里面绑定事件，根据新的CSS样式名来写新的交互效果，而在AngularJS上，有些不用做了（例如为了jQuery选择器，而为HTML元素增加新的class、id；在JavaScript中绑定事件），有些（例如交互效果）则只要改HTML就行，而不是改JavaScript。</p>
<p><strong>AngularJS为我们省去的代码量</strong></p>
<p>对于任何项目来说，代码臃肿、冗余是可维护性的天敌。</p>
<p>因此，实现同样的功能，代码量越少，抽象度越高，冗余度越低，在某种程度上意味着项目更方便维护。而能减少代码量，也是AngularJS被推崇的一大优点。让我们来看看，它是如何减少了代码量的：</p>
<p>首先，作为一个大而全的框架（双刃剑，有利有弊)，AngularJS提供的诸多特性，使我们可以更专注于业务代码的编写。</p>
<p>其次，AngularJS双向数据绑定的特性，将我们从大量的值绑定代码中解放出来。</p>
<p>和jQuery对比，AngularJS不用为了选择某个元素，而刻意为HTML加上一些跟样式无关的class、2-2-2. id；</p>
<p>不用写一堆从HTML元素中取值，设值的代码；不用在JavaScript代码中绑定事件；不用在JavaScript值发生变化时写代码去更新HTML对应的值。</p>
<p>双向数据绑定，让我们告别很多简单无趣的绑定事件、绑定值的代码。</p>
<p>Directive、Filter、Factory等，天然的就是一个个可以复用的组件，减少了冗余重复代码。一些需要公用的逻辑，如果放在Controller中，都会相当别扭，就这样被AngularJS“逼着”，把公用逻辑都放到Directive、Filter、Factory中去。</p>
<hr>
<blockquote>
<p>开发心得总结</p>
</blockquote>
<p><strong>我理解的AngularJS基础组件</strong></p>
<p>化繁为简，几大基础组件的使用场景</p>
<p>首先我们需要理清AngularJS几个组件的使用场景。</p>
<p>AngularJS的一个毛病，就是新概念，新特性太多，新手一下子要了解这么多，学习曲线略陡。</p>
<p>为了帮助大家理解，总结下我理解的几大组件使用场景。<br>请求资源与数据缓存的东西放进Service。Factory、Service本质上都是Provider的语法糖，两者只是使用方式有所不同，建议大家直接都用Service，ES6 class更容易，之后想平滑迁移到Angular2也会更容易，同时也能避免团队成员在选择Service还是Factory时产生困惑。</p>
<p>数据需要格式化的东西用Filter处理。例如把status值转化为中文值，把时间戳转成时间字符串之类。</p>
<p>需要公用的DOM操作，放在指令中去写。另外，如果需要引入jQuery组件，也可以写个指令把jQuery组件初始化代码放进去。</p>
<p>Controller与视图按照一对一的关系维护，在Controller内初始化Scope对象与在Scope上添加方法（行为），为ViewModel做赋值。其他所有过程都不应该出现在Controller中。</p>
<p>Controller中不应该出现和页面展示、交互相关的代码。例如展示隐藏某些元素之类，这些应该是HTML模板或者指令负责。代码越薄越好。</p>
<p>全局常量值放到Constant。</p>
<p>指令（Directive）魔法</p>
<p>指令这个特性，用“魔法”一词来形容它，都不为过。</p>
<p>解决的痛点：一言以蔽之，指令提供了一套前端组件化的方法及约定，这使得编写，使用UI组件更加方便了。相对于jQuery，它解决了以下痛点：</p>
<p>动态生成了HTML元素后，不用再手动去为其加上JavaScript特性。</p>
<p>举个例子：HTML原生的checkbox框比较丑，在jQuery时代，可以将checkbox替换成自定义的效果，如果是页面一开始就有的checkbox，我们可以在document.ready的时候调用自定义checkbox的初始化方法。但是，如果这个checkbox是动态生成的，在每个动态生成checkbox的地方，我们都得去调用checkbox的初始化方法，相当麻烦。但用了AngularJS的指令，就不会有这个问题了，只要在模板的chceckbox中加上指令，不管这个模板是动态变化的还是静态的，无需通过业务代码来逐个调用初始化方法，呈现给用户的，就已经是AngularJS替换后的checkbox效果。</p>
<p>一个组件的HTML和JavaScript，是一个整体，而不是割裂的（题外话，这一点React做得比Angular1.x还要好）。</p>
<p>基于jQuery的UI组件，其引入方法，经常是这样的，首先，要求你自己copy一段指定的HTML，然后再调用初始化方法。而指令则支持定义对应的模板HTML，用户在引入时，可能只要写一个指令标签，就会自动生成N行的HTML及绑定对应的JavaScript效果。</p>
<p>当然，理论上jQuery也能做到这样，但是会比Angular的实现麻烦许多。</p>
<p>应用、移除UI特性时方便直观。</p>
<p>假设有这么一个需求，给一个普通输入框增加输入限制，只能输入特定字符（如字母数字），写好对应指令，只要给这个input输入框加上这个指令标签，就能马上应用这个特性，之后要移除，只要把标签去掉就好。</p>
<p>相比之下，jQuery就会麻烦多。jQuery下，一般是通过元素选择器来绑定JavaScript效果。因此，在添加该特性时，你需要考虑给对应的输入框指定一个合适的元素选择器。移除特性时，你要考虑：有可能你在动态生成输入框的地方，都加了这些初始化代码，这些JavaScript都需要移除；如果元素选择器用的是class，得考虑是不是其他输入框也有这个class，如果是，那么移除代码时也会影响到其他输入框。</p>
<p><strong>技巧</strong></p>
<p>如果你迫不得已需要引入jQuery组件，你可以写一个指令把它包装起来，在该指令中初始化组件。</p>
<p>要注意require参数中的值是驼峰的，在HTML中就得转成对应的中划线命名，例如有require参数phoneKey，那么HTML中应为phone-key=”xxx”。</p>
<p>虽然这个道理很浅显，但经常一不小心就会弄错了，然后发现在指令内部怎么着都拿不到require参数。</p>
<p>如果你在link中加了elm.bind(‘click’)，当click回调函数中，作用域的值发生变化，记得调用scope.$apply()，否则值变化不会生效。</p>
<p><strong>文件、目录约定</strong></p>
<p><em>目录结构</em></p>
<p>第三方库、CSS、图片放置到哪个目录，不在本文讨论范围，这里略过。需要进一步说明的，是业务代码目录。</p>
<p>我们将系统自身的JavaScript、HTML模板都放在pages目录，其中子目录common放置公用的JavaScript及模板；<br>其他子目录，以功能模块名作为目录名，然后将这个模块相关的JavaScript及模板放在其中。</p>
<p>这样开发同个模块功能时，可以方便地在HTML及对应JavaScript之间切换。</p>
<p>有些代码规范可能还会建议在模块这一级目录下，再根据AngularJS的几大组件Controller、Filter、Service等，创建不同的子目录，例如模块A/controller，模块A/service之类，我们则将所有JavaScript及HTML放在同一级，这样做主要有几个原因：</p>
<p>我们的项目，平均每个模块只有十来个文件，特别是每个模块一般只有一个Filter及Service，为了这一个文件创建一个目录，显得多此一举。</p>
<p>通过文件名，已经可以很方便地区分不同的JavaScript组件类型及HTML模板类型，同时，由于IDE一般会按照文件名字母排序，所以相同功能的JavaScript及HTML会挨在一起，查找对应的模板或JavaScript代码会方便很多。</p>
<p><em>文件名约定</em></p>
<p>这个约定对于Angular来说，特别重要。具体的约定是：</p>
<p>例如，为“防火墙”模块开发“创建防火墙”的功能，它的Controller，对应的JavaScript为：firewall.create.ctrl.js，对应的HTML模板为：</p>
<p>firewall.create.ctrl.HTML。为了文件名书写的方便，定义了组件的简写：controller -&gt; ctrl ；factory,service -&gt; svr ； filter-&gt; fil ； directive -&gt; dire。</p>
<p>这样约定有两个显而易见的优点：</p>
<p>通过文件名，就能知道对应模块、AngularJS基本组件类型、是模板HTML还是JavaScript 。</p>
<p>相同功能的JavaScript及HTML，会挨在一起（如果IDE是按照文件命名排序）。</p>
<p><em>与后端服务器通信</em></p>
<p>根据后台接口规范，结合AngularJS自身能力，我们做了一些封装，使接口请求逻辑变得非常简单。具体问题具体分析，先看看我们的后台接口的标准响应格式是怎样的，前端会按照这个接口返回格式做一些定制：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&#123; <span class="attr">errno</span>:<span class="number">0</span>, <span class="attr">errmsg</span>:<span class="string">""</span>, <span class="attr">data</span>:[ &#123; <span class="attr">id</span>:<span class="string">"test"</span>, <span class="attr">name</span>:<span class="string">"test"</span> &#125;</div><div class="line">    ]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们项目服务端的标准响应是一个json，通过errno描述此次请求的结果码，通过errmsg描述出错的原因（假如请求出错的话），通过data返回正常数据。</p>
<p><em>出错处理</em><br>当接口返回的errno!=0时，说明接口返回异常（系统异常或用户输入错误），这时我们希望能弹框提示用户“出错了”。显然，如果在每个接口请求逻辑中，都去写这个逻辑，会非常累赘，所幸AngularJS提供了拦截器的功能，我们只要写一个拦截器，就可以对所有的异常返回做统一处理。 </p>
<p>首先，我们需要显式地抛出HTTP错误。因为当后台逻辑出错或者用户输入参数有误时，返回的HTTP状态码都是200（这只是我们项目的约定），AngularJS并不会认为200是出错的情况，因此，我们需要做点小动作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">$httpProvider.defaults.transformResponse.push(<span class="function"><span class="keyword">function</span> (<span class="params">responseData</span>) </span>&#123;</div><div class="line">            <span class="keyword">if</span> (responseData.errno != <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">throw</span> responseData;</div><div class="line">            &#125;</div><div class="line">            ……</div><div class="line">      &#125;);</div><div class="line">AngularJS的</div><div class="line">httpProvider.interceptors捕获这个异常并弹框，代码如下：</div><div class="line">$httpProvider.interceptors.push(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123;</div><div class="line">     <span class="attr">responseError</span>: <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">       <span class="keyword">if</span> (response) &#123;</div><div class="line">          <span class="keyword">if</span> (response.hasOwnProperty(<span class="string">"errmsg"</span>)) &#123;</div><div class="line">              <span class="keyword">if</span> (response.errno &gt; <span class="number">0</span>) &#123;</div><div class="line">                                alert(response.errmsg);</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">             alert(<span class="string">"系统维护中，请稍候重试"</span>);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">         &#125;</div><div class="line">         <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span> (response.status == <span class="number">404</span>) &#123;</div><div class="line">               alert(<span class="string">"抱歉，后台服务出错,找不到对应的接口"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                alert(<span class="string">"抱歉，后台服务出错"</span>);</div><div class="line">            &#125;</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">       &#125;</div><div class="line">     &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>有些人可能会问，为啥不直接在一开始的transformResponse函数中写错误处理逻辑呢？</p>
<p>这是因为，接口正常时，AngularJS会依次调用transformResponse函数，再调用interceptors的responseError。</p>
<p>但是，某些异常情况，并不会调用transformResponse逻辑，例如，当URL不存在时，Web容器默认返回的404页面，或者当程序出错时，系统代码未处理这个错误，Web容器会返回默认的500页面，这时均会直接进入interceptors的responseError中。</p>
<p>因此，为了覆盖所有的异常情况，需要在transformResponse中抛出异常，然后由responseError统一处理。</p>
<p>2 响应内容格式化</p>
<p>由于前端关心的数据，是放在响应内容的data属性中。</p>
<p>而另外两个属性errno、errmsg，当返回正常数据时，前端是不关心的，为了取数据时更加方便，可以进一步优化transformResponse中的处理。当errno==0时，都返回responseData.data，这样，在业务逻辑里面，就可以直接使用data了，而不用取xxx.data。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">$httpProvider.defaults.transformResponse.push(<span class="function"><span class="keyword">function</span> (<span class="params">responseData</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (responseData &amp;&amp; responseData.hasOwnProperty(<span class="string">"errno"</span>) &amp;&amp; responseData.hasOwnProperty(<span class="string">"errmsg"</span>) &amp;&amp; responseData.hasOwnProperty(<span class="string">"data"</span>)) &#123;</div><div class="line">            <span class="keyword">if</span> (responseData.errno == <span class="number">0</span>) &#123;</div><div class="line">                <span class="keyword">if</span> (Angular.isArray(responseData.data) || Angular.isObject(responseData.data)) &#123;</div><div class="line">                    <span class="keyword">return</span> responseData.data;</div><div class="line">                &#125; <span class="keyword">else</span> &#123;</div><div class="line">                    <span class="keyword">return</span> responseData</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">throw</span> responseData;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> responseData;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
<p>3 对$resource做进一步封装</p>
<p>项目中每个模块，都创建了对应的service文件，用于与后台进行通信。例如“硬盘”模块，对应DiskSvr，“防火墙“模块，对应FirewallSvr。这样划分后，前端所有的后台请求逻辑，找起来会很方便。</p>
<p>在封装后台通信逻辑时，我们用到$resource，这是AngularJS自身的一个组件，当你的后台接口符合RESTFul规范时，你可以很方便地使用resource和后台进行通信。</p>
<p>而由于我们的后台并不是完整的RESTFul实现，我们需要做一些简单的封装。示意代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">app.factory(<span class="string">"DiskSvr"</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> url = <span class="string">"schedule/disk"</span>;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> customAPI = &#123;</div><div class="line">        <span class="attr">clone</span>: &#123;</div><div class="line">            <span class="attr">method</span>: <span class="string">"post"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> getApi(url, customAPI);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">//公用的，每个Svr都可以用</span></div><div class="line">getApi = <span class="function"><span class="keyword">function</span> (<span class="params">path, customAPI</span>) </span>&#123;</div><div class="line"></div><div class="line">    Angular.forEach(customAPI, <span class="function"><span class="keyword">function</span> (<span class="params">value, key</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (!value.url) &#123;</div><div class="line">            value.url = util.connectPath(path, key);</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            value.url = util.connectPath(path, value.url);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"></div><div class="line">    <span class="comment">//所有的</span></div><div class="line">    <span class="keyword">var</span> defaultAPI = &#123;</div><div class="line">        <span class="attr">detail</span>: &#123;</div><div class="line">            <span class="attr">url</span>: baseUrl + <span class="string">"/get"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">delete</span>: &#123;</div><div class="line">            <span class="attr">url</span>: baseUrl + <span class="string">"/delete"</span>,</div><div class="line">            <span class="attr">method</span>: <span class="string">"delete"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">create</span>: &#123;</div><div class="line">            <span class="attr">url</span>: baseUrl + <span class="string">"/create"</span>,</div><div class="line">            <span class="attr">method</span>: <span class="string">"post"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">update</span>: &#123;</div><div class="line">            <span class="attr">url</span>: baseUrl + <span class="string">"/update"</span>,</div><div class="line">            <span class="attr">method</span>: <span class="string">"put"</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $resource(path, &#123;&#125;, Angular.extend(defaultAPI, customAPI));</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面的代码，主要做了这些事情：</p>
<p>为所有的svr注入了每个模块接口都必备的，最基础的增删改查四个接口。这样就无需在每个svr中加入这些接口。例如，在业务逻辑中调用DiskSvr.create()，就会用post请求调用schedule/disk/create接口。</p>
<p>简化了新增接口的配置。新增一个接口，只要配置对应的HTTP方法及名字即可。</p>
<p>通过引用$resource组件、进一步封装及svr文件，在业务Controller中，不会看到任何的和后台通信的基础代码，如果在这个Controller中你需要和后台通信，你只需注入响应的svr，然后调用对应方法即可。</p>
<p>4 注入请求header头</p>
<p>在我们的项目中，约定了所有的请求都要在header中带上一些相同的信息，这对AngularJS来说，是非常简单的事情： 执行以下代码后，之后所有的HTTP请求都会带上名为project的header信息：</p>
<p>Controller间通信问题</p>
<p>Controller调用</p>
<p>假设controllerA希望调用controllerB的某个函数，告诉同伴Controller，我的某个你所关心的东西改变了，要怎么做呢？举具体业务场景，有两个Controller，一个是主页Controller，另外主页上有个弹框表单，这个弹框表单也有个Controller，用户成功提交了这个表单后，弹框Controller需要告知</p>
<p>主页Controller，“哥们，请更新主页上的某项数据”。建议的做法，是用AngularJS的消息机制。例如，上面的例子中，弹框Controller是主页Controller的子Controller。</p>
<p>那么弹框Controller可以往上冒泡传递消息：</p>
<p>其父Controller去捕获这个消息：</p>
<p>这是一种很好的解耦办法，假设这两个Controller是由两个开发负责的，那么我开发我的Controller，你开发你的，我不用去关心你那边的逻辑。</p>
<p>2 数据共享</p>
<p>多个Controller之间要共享数据，要怎么做呢？ </p>
<p>最简单但也不推荐的一个做法，就是把数据塞到rootscope中，但是，这就像JavaScript的全局变量，野蛮不好控制。 </p>
<p>这里推荐下我们的做法：写一个专门用于存储、设置共享数据的共享数据Facoty。在里面定义set方法，所有的共享变量，都需要经过set方法来设置。然后取数据则通过DATA变量获取。 </p>
<p>伪代码如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">app.factory(‘ShareSvr’, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line"><span class="keyword">var</span> shareData = &#123;</div><div class="line">peopleNum</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> &#123;</div><div class="line"><span class="attr">DATA</span>:shareData,</div><div class="line"><span class="attr">setPepleNum</span>:<span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</div><div class="line">shareData.peopleNum = num;</div><div class="line">&#125;</div><div class="line">&#125;</div><div class="line">&#125;);</div><div class="line">app.controller(‘TestController’,<span class="function"><span class="keyword">function</span>(<span class="params">ShareSvr</span>)</span>&#123;</div><div class="line"><span class="keyword">var</span> self = <span class="keyword">this</span>;</div><div class="line"><span class="keyword">this</span>.DATA = ShareSvr.DATA;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里并没有要求DATA值只能通过g alert(“Hello CSDN”); et方法获取，是为了之后在Controller对应的视图HTML中取值方便些。</p>
<p>第三方 库/资源 推荐</p>
<p>UI Router</p>
<p>路由（route），几乎所有的MVC框架都应该具有的特性，它是前端构建单页面应用（SPA）必不可少的组成部分。相比原生的ngRouter，UI Router功能更加强大，具备多视图，嵌套路由等特性，可以解决路由大部分的应用场景。</p>
<p>ngDialog</p>
<p>一个弹框控件，功能强大，我比较喜欢的地方，是它没有写死弹框的HTML、可以很方便地定义自己想要的弹框模板。例如，我们项目就通过它做了两种弹框，一种是普通弹框，一种是侧拉框（从屏幕右侧滑出，占满浏览器高度，宽度占满一半屏幕（或者其他自定义宽度）。</p>
<p>AngularJS代码规范</p>
<p><code>3-1. https://github.com/johnpapa/angular-styleguide/blob/master/a1/i18n/zh-CN.md</code></p>
<p><code>3-2. https://github.com/mgechev/Angularjs-style-guide/blob/master/README-zh-cn.md</code></p>
<p>Angular-filter</p>
<p>提供了很多实用的filter，string类、math类，集合类等。</p>
<p>w5c-validator</p>
<p>基于Angular.js原有的表单验证，统一验证规则和提示信息，在原有的基础上扩展了一些错误提示的功能，让大家不用在每个表单上写一些提示信息的模板，专心的去实现业务逻辑，国人出品。</p>
<p>ng-table</p>
<p>轻量，功能强大的表格组件。可以很方便地修改表格的样式、交互效果。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/12/06/YY游戏云平台在AngularJS上的实践总结/" data-id="cj3xtejgi00054se9aiot6ebm" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-angular父controller、子controller、同级controller之间的通讯" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/12/02/angular父controller、子controller、同级controller之间的通讯/" class="article-date">
  <time datetime="2016-12-02T07:19:00.000Z" itemprop="datePublished">2016-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/12/02/angular父controller、子controller、同级controller之间的通讯/">angular父controller、子controller、同级controller之间的通讯</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在同个  angular.js 应用的控制器之间进行通信可以有很多种不同的方式，本文主要讲两种：</p>
<ul>
<li>基于scope继承的方式</li>
<li>基于event传播的方式</li>
</ul>
<blockquote>
<p>基于scope继承的方式</p>
</blockquote>
<p>最简单的让控制器之间进行通信的方法是通过scope的继承。</p>
<p>假设有两个控制器Parent、Child，Child 在 Parent 内，那Child 可以称为子控制器，它将继承父控制器Parent的scope。</p>
<p>这样，Child就可以访问到Parent的scope中的所有函数和变量了。<br>需要注意的是，由于scope的继承也是基于Js的原型继承，如果变量是基本类型的，那在Child中的修改（写），有可能会导致Parent中的数据变脏</p>
<p>基本类型变量的继承</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">function Sandcrawler($scope) &#123;</div><div class="line">    $scope.location = 'Mos Eisley North';</div><div class="line">    $scope.move = function(newLocation) &#123;</div><div class="line">        $scope.location = newLocation;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">function Droid($scope) &#123;</div><div class="line">    $scope.sell = function(newLocation) &#123;</div><div class="line">        $scope.location = newLocation;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">// html</div><div class="line">&lt;div ng-controller="Sandcrawler"&gt;</div><div class="line">    &lt;p&gt;Location: &lt;/p&gt;</div><div class="line">    &lt;button ng-click="move('Mos Eisley South')"&gt;Move&lt;/button&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;p&gt;Location: &lt;/p&gt;</div><div class="line">        &lt;button ng-click="sell('Owen Farm')"&gt;Sell&lt;/button&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>看完上面的代码我们知道，location 属性是直接被注册到 $scope 中的，Droid控制器所拥有的scope从Sandcrawler控制器的scope中继承了这个属性并且可以读取它。</p>
<p>看以下两个假设场景：</p>
<p>如果 Sandcrawler 中改变了 location 属性，在 Droid 中也会读取到这个改变；</p>
<p>在 view 中的表现则是：点击了 Move 按钮的话，两个 p 标签都会显示 Mos Eisley South</p>
<p>反过来，如果 Droid 中对 $scope.location 进行改写，它只改写自己scope中 location 属性的值，它不会影响 Sandcrawler 中的这个属性的值；</p>
<p>在 view 中的表现则是：当点击了 Sell 按钮之后，两个控制器scope之间的数据共享就不复存在了，之后无论点多少次 Move 按钮，都影响不了 Droid 中的 p 标签的显示了</p>
<p>经过上面的教训，有时候我们想要达到的效果可能达不到（如点了 Sell 按钮之后再点 Move 还想让它起作用），这样在ng的开发者中逐渐达成了一个一致的约定，千万不要把那些可以被子级scope改写的属性用基础类型直接添加在 $scope 对象上，而是应该尽可能地用对象类型去添加</p>
<p><em>对象类型变量的继承</em></p>
<p>通过上面的结论我们知道，可以用对象类型的变量来作为属性添加到 $scope 中去，这样，只要是引用了这个对象的，无论是谁，在哪个控制器里面，对这个对象变量的改写都会影响都所有引用了这个对象的实例。</p>
<p>看下面的代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">function Sandcrawler($scope) &#123;</div><div class="line">    $scope.sandcrawler.location = 'Mos Eisley North';</div><div class="line">&#125;</div><div class="line"></div><div class="line">function Droid($scope) &#123;</div><div class="line">    $scope.summon = function(newLocation) &#123;</div><div class="line">        $scope.sandcrawler.location = newLocation;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">// html</div><div class="line">&lt;div ng-controller="Sandcrawler"&gt;</div><div class="line">    &lt;p&gt;Sandcrawler Location: &lt;/p&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;button ng-click="summon('Owen Farm')"&gt;</div><div class="line">            Summon Sandcrawler</div><div class="line">        &lt;/button&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>跑一下上面的代码就知道，当我们使用“召唤术”的时候，可以改写 Sandcrawler 控制下的 p 标签的显示了</p>
<blockquote>
<p>基于event传播的方式</p>
</blockquote>
<p>基于scope继承的方式只能处理父子级控制器之间的通信问题，不能处理兄弟/相邻控制器之间的通信问题。</p>
<p>这时候，我们需要使用基于event传播的方式来进行通信，这里，ng为我们提供了三个方法：$on , $emit , $broadcast ，需要明确的是：这种方法不仅可以处理兄弟scope间的通信问题，对于解决父子scope间的通信也是毫无压力</p>
<p><strong>子–&gt;父：$emit</strong></p>
<p>整个过程是这样的：</p>
<p>子scope中的控制器通过 $scope.$emit 触发一个事件向上传播</p>
<p>这个事件会经过每一层的父scope，至于处不处理是父scope自己的事情了</p>
<p>如果处理，就在想要处理的那个祖先scope中放一个 $scope.$on 监听着就行了</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// 父scope上的控制器</div><div class="line">function Sandcrawler($scope) &#123;</div><div class="line">    $scope.location = 'Mos Eisley North';</div><div class="line">    $scope.$on('summon', function(e, newLocation) &#123;</div><div class="line">        $scope.location = newLocation;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">// 子scope上的控制器</div><div class="line">function Droid($scope) &#123;</div><div class="line">    $scope.location = 'Owen Farm';</div><div class="line">    $scope.summon = function() &#123;</div><div class="line">        $scope.$emit('summon', $scope.location);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">// html</div><div class="line">&lt;div ng-controller="Sandcrawler"&gt;</div><div class="line">    &lt;p&gt;Sandcrawler Location: &lt;/p&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;p&gt;Droid Location: &lt;/p&gt;</div><div class="line">        &lt;button ng-click="summon()"&gt;Summon Sandcrawler&lt;/button&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>跟我之前写的一篇DOM事件一样，如果你不想让你的事件再往更上层传播，在 $on 中的处理函数调用 e.stopPropagation() 即可</p>
<p><strong>父–&gt;子：$broadcast</strong></p>
<p>接下来的东西就简单了，从父到子，用另外一个方法就是了，同样用 $on 监听着，all done，看下面代码：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// 父scope上的控制器</div><div class="line">function Sandcrawler($scope) &#123;</div><div class="line">    $scope.location = 'Mos Eisley North';</div><div class="line">    $scope.recall = function() &#123;</div><div class="line">        $scope.$broadcast('recall', $scope.location);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">// 子scope上的控制器</div><div class="line">function Droid($scope) &#123;</div><div class="line">    $scope.location = 'Owen Farm';</div><div class="line">    $scope.$on('recall', function(e, newLocation) &#123;</div><div class="line">        $scope.location = newLocation;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">// html</div><div class="line">&lt;div ng-controller="Sandcrawler"&gt;</div><div class="line">    &lt;p&gt;Sandcrawler Location: &lt;/p&gt;</div><div class="line">    &lt;button ng-click="recall()"&gt;Recall Droids&lt;/button&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;p&gt;Droid Location: &lt;/p&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>同级之间</p>
<p>拥有同个父scope的子级scope之间，也就是兄弟/相邻scope之间的通信，其实是借助“奶爸”传递消息的：</p>
<p>子级scope中有谁想传消息了，$emit 一个给“奶爸”</p>
<p>然后通过“奶爸” $broadcast 给所有孩子这个相同的信息，当然发出信息的那个可以选择是否要忽略掉自己发出的信息</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">// 父scope上的控制器</div><div class="line">function Sandcrawler($scope) &#123;</div><div class="line">    $scope.$on('requestDroidRecall', function(e) &#123;</div><div class="line">        $scope.$broadcast('executeDroidRecall');</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">// 子scope上的控制器</div><div class="line">function Droid($scope) &#123;</div><div class="line">    $scope.location = 'Owen Farm';</div><div class="line">    $scope.recallAllDroids = function() &#123;</div><div class="line">        $scope.$emit('requestDroidRecall');</div><div class="line">    &#125;</div><div class="line">    $scope.$on('executeDroidRecall', function() &#123; </div><div class="line">        $scope.location = 'Sandcrawler';</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line">// html</div><div class="line">&lt;div ng-controller="Sandcrawler"&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;h2&gt;R2-D2&lt;/h2&gt;</div><div class="line">        &lt;p&gt;Droid Location: &lt;/p&gt;</div><div class="line">        &lt;button ng-click="recallAddDroids()"&gt;Recall All Droids&lt;/button&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">    &lt;div ng-controller="Droid"&gt;</div><div class="line">        &lt;h2&gt;C-3PO&lt;/h2&gt;</div><div class="line">        &lt;p&gt;Droid Location: &lt;/p&gt;</div><div class="line">        &lt;button ng-click="recallAddDroids()"&gt;Recall All Droids&lt;/button&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
<p>上面代码中要注意的是：子scope通过 $emit 发出的事件名不能与父scope用 $broadcast 的事件名一样，如果有传参数，那当然参数可以一样，因为参数就是我们要传的数据。</p>
<p>事件名不能一样是为了防止进入死循环。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/12/02/angular父controller、子controller、同级controller之间的通讯/" data-id="cj3xtejgn00094se9uiebq5mp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-JSONP的原理，JSON和JSONP区别，也许你会豁然开朗，含jQuery用例" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/30/JSONP的原理，JSON和JSONP区别，也许你会豁然开朗，含jQuery用例/" class="article-date">
  <time datetime="2016-11-30T09:21:00.000Z" itemprop="datePublished">2016-11-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/30/JSONP的原理，JSON和JSONP区别，也许你会豁然开朗，含jQuery用例/">JSONP的原理，JSON和JSONP区别，也许你会豁然开朗，含jQuery用例</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <blockquote>
<p>前言</p>
</blockquote>
<p>说到AJAX就会不可避免的面临两个问题，第一个是AJAX以何种格式来交换数据？第二个是跨域的需求如何解决？</p>
<p>这两个问题目前都有不同的解决方案，比如数据可以用自定义字符串或者用XML来描述，跨域可以通过服务器端代理来解决。</p>
<p>但到目前为止最被推崇或者说首选的方案还是用JSON来传数据，靠JSONP来跨域。而这就是本文将要讲述的内容。</p>
<p>JSON和JSONP虽然只有一个字母的差别，但其实他们根本不是一回事儿：JSON是一种数据交换格式，而JSONP是一种依靠开发人员的聪明才智创造出的一种非官方跨域数据交互协议。</p>
<p>我们拿最近比较火的谍战片来打个比方，JSON是地下党们用来书写和交换情报的“暗号”，而JSONP则是把用暗号书写的情报传递给自己同志时使用的接头方式。</p>
<p>看到没？一个是描述信息的格式，一个是信息传递双方约定的方法。</p>
<p>既然随便聊聊，那我们就不再采用教条的方式来讲述，而是把关注重心放在帮助开发人员理解是否应当选择使用以及如何使用上。</p>
<blockquote>
<p>什么是JSON？</p>
</blockquote>
<p>前面简单说了一下，JSON是一种基于文本的数据交换方式，或者叫做数据描述格式，你是否该选用他首先肯定要关注它所拥有的优点。</p>
<p>JSON的优点：</p>
<ol>
<li>基于纯文本，跨平台传递极其简单；</li>
<li>Javascript原生支持，后台语言几乎全部支持；</li>
<li>轻量级数据格式，占用字符数量极少，特别适合互联网传递；</li>
<li>可读性较强，虽然比不上XML那么一目了然，但在合理的依次缩进之后还是很容易识别的；</li>
<li>容易编写和解析，当然前提是你要知道数据结构；</li>
</ol>
<p>JSON的缺点当然也有，但在作者看来实在是无关紧要的东西，所以不再单独说明。</p>
<p>JSON的格式或者叫规则：</p>
<p>JSON能够以非常简单的方式来描述数据结构，XML能做的它都能做，因此在跨平台方面两者完全不分伯仲。</p>
<p>1、JSON只有两种数据类型描述符，大括号{}和方括号[]，其余英文冒号:是映射符，英文逗号,是分隔符，英文双引号””是定义符。</p>
<p>2、大括号{}用来描述一组“不同类型的无序键值对集合”（每个键值对可以理解为OOP的属性描述），方括号[]用来描述一组“相同类型的有序数据集合”（可对应OOP的数组）。</p>
<p>3、上述两种集合中若有多个子项，则通过英文逗号,进行分隔。</p>
<p>4、键值对以英文冒号:进行分隔，并且建议键名都加上英文双引号””，以便于不同语言的解析。</p>
<p>5、JSON内部常用数据类型无非就是字符串、数字、布尔、日期、null 这么几个，字符串必须用双引号引起来，其余的都不用，日期类型比较特殊，这里就不展开讲述了，只是建议如果客户端没有按日期排序功能需求的话，那么把日期时间直接作为字符串传递就好，可以省去很多麻烦。</p>
<p>JSON实例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 描述一个人</span></div><div class="line"><span class="keyword">var</span> person = &#123;</div><div class="line">    <span class="string">"Name"</span>: <span class="string">"Bob"</span>,</div><div class="line">    <span class="string">"Age"</span>: <span class="number">32</span>,</div><div class="line">    <span class="string">"Company"</span>: <span class="string">"IBM"</span>,</div><div class="line">    <span class="string">"Engineer"</span>: <span class="literal">true</span></div><div class="line">&#125;</div><div class="line"><span class="comment">// 获取这个人的信息</span></div><div class="line"><span class="keyword">var</span> personAge = person.Age;</div><div class="line"><span class="comment">// 描述几个人</span></div><div class="line"><span class="keyword">var</span> members = [</div><div class="line">    &#123;</div><div class="line">        <span class="string">"Name"</span>: <span class="string">"Bob"</span>,</div><div class="line">        <span class="string">"Age"</span>: <span class="number">32</span>,</div><div class="line">        <span class="string">"Company"</span>: <span class="string">"IBM"</span>,</div><div class="line">        <span class="string">"Engineer"</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="string">"Name"</span>: <span class="string">"John"</span>,</div><div class="line">        <span class="string">"Age"</span>: <span class="number">20</span>,</div><div class="line">        <span class="string">"Company"</span>: <span class="string">"Oracle"</span>,</div><div class="line">        <span class="string">"Engineer"</span>: <span class="literal">false</span></div><div class="line">    &#125;,</div><div class="line">    &#123;</div><div class="line">        <span class="string">"Name"</span>: <span class="string">"Henry"</span>,</div><div class="line">        <span class="string">"Age"</span>: <span class="number">45</span>,</div><div class="line">        <span class="string">"Company"</span>: <span class="string">"Microsoft"</span>,</div><div class="line">        <span class="string">"Engineer"</span>: <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">]</div><div class="line"><span class="comment">// 读取其中John的公司名称</span></div><div class="line"><span class="keyword">var</span> johnsCompany = members[<span class="number">1</span>].Company;</div><div class="line"><span class="comment">// 描述一次会议</span></div><div class="line"><span class="keyword">var</span> conference = &#123;</div><div class="line">    <span class="string">"Conference"</span>: <span class="string">"Future Marketing"</span>,</div><div class="line">    <span class="string">"Date"</span>: <span class="string">"2012-6-1"</span>,</div><div class="line">    <span class="string">"Address"</span>: <span class="string">"Beijing"</span>,</div><div class="line">    <span class="string">"Members"</span>: </div><div class="line">    [</div><div class="line">        &#123;</div><div class="line">            <span class="string">"Name"</span>: <span class="string">"Bob"</span>,</div><div class="line">            <span class="string">"Age"</span>: <span class="number">32</span>,</div><div class="line">            <span class="string">"Company"</span>: <span class="string">"IBM"</span>,</div><div class="line">            <span class="string">"Engineer"</span>: <span class="literal">true</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="string">"Name"</span>: <span class="string">"John"</span>,</div><div class="line">            <span class="string">"Age"</span>: <span class="number">20</span>,</div><div class="line">            <span class="string">"Company"</span>: <span class="string">"Oracle"</span>,</div><div class="line">            <span class="string">"Engineer"</span>: <span class="literal">false</span></div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">            <span class="string">"Name"</span>: <span class="string">"Henry"</span>,</div><div class="line">            <span class="string">"Age"</span>: <span class="number">45</span>,</div><div class="line">            <span class="string">"Company"</span>: <span class="string">"Microsoft"</span>,</div><div class="line">            <span class="string">"Engineer"</span>: <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    ]</div><div class="line">&#125;</div><div class="line"><span class="comment">// 读取参会者Henry是否工程师</span></div><div class="line"><span class="keyword">var</span> henryIsAnEngineer = conference.Members[<span class="number">2</span>].Engineer;</div></pre></td></tr></table></figure>
<p>关于JSON，就说这么多，更多细节请在开发过程中查阅资料深入学习。</p>
<blockquote>
<p>什么是JSONP？</p>
</blockquote>
<p>先说说JSONP是怎么产生的：</p>
<p>其实网上关于JSONP的讲解有很多，但却千篇一律，而且云里雾里，对于很多刚接触的人来讲理解起来有些困难，小可不才，试着用自己的方式来阐释一下这个问题，看看是否有帮助。</p>
<p>1、一个众所周知的问题，Ajax直接请求普通文件存在跨域无权限访问的问题，甭管你是静态页面、动态网页、web服务、WCF，只要是跨域请求，一律不准；</p>
<p>2、不过我们又发现，Web页面上调用js文件时则不受是否跨域的影响（不仅如此，我们还发现凡是拥有”src”这个属性的标签都拥有跨域的能力，比如<script>、<img>、<iframe>）；</p>
<p>3、于是可以判断，当前阶段如果想通过纯web端（ActiveX控件、服务端代理、属于未来的HTML5之Websocket等方式不算）跨域访问数据就只有一种可能，那就是在远程服务器上设法把数据装进js格式的文件里，供客户端调用和进一步处理；</p>
<p>4、恰巧我们已经知道有一种叫做JSON的纯字符数据格式可以简洁的描述复杂数据，更妙的是JSON还被js原生支持，所以在客户端几乎可以随心所欲的处理这种格式的数据；</p>
<p>5、这样子解决方案就呼之欲出了，web客户端通过与调用脚本一模一样的方式，来调用跨域服务器上动态生成的js格式文件（一般以JSON为后缀），显而易见，服务器之所以要动态生成JSON文件，目的就在于把客户端需要的数据装入进去。</p>
<p>6、客户端在对JSON文件调用成功之后，也就获得了自己所需的数据，剩下的就是按照自己需求进行处理和展现了，这种获取远程数据的方式看起来非常像AJAX，但其实并不一样。</p>
<p>7、为了便于客户端使用数据，逐渐形成了一种非正式传输协议，人们把它称作JSONP，该协议的一个要点就是允许用户传递一个callback参数给服务端，然后服务端返回数据时会将这个callback参数作为函数名来包裹住JSON数据，这样客户端就可以随意定制自己的函数来自动处理返回数据了。</p>
<p>如果对于callback参数如何使用还有些模糊的话，我们后面会有具体的实例来讲解。</p>
<hr>
<blockquote>
<p><strong>JSONP的客户端具体实现</strong></p>
</blockquote>
<p>不管jQuery也好，extjs也罢，又或者是其他支持jsonp的框架，他们幕后所做的工作都是一样的，下面我来循序渐进的说明一下jsonp在客户端的实现：</p>
<p>1、我们知道，哪怕跨域js文件中的代码（当然指符合web脚本安全策略的），web页面也是可以无条件执行的。</p>
<p>远程服务器remoteserver.com根目录下有个remote.js文件代码如下：</p>
<p><code>alert(&#39;我是远程文件&#39;);</code></p>
<p>本地服务器localserver.com下有个jsonp.html页面代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://remoteserver.com/remote.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>毫无疑问，页面将会弹出一个提示窗体，显示跨域调用成功。</p>
<p>2、现在我们在jsonp.html页面定义一个函数，然后在远程remote.js中传入数据进行调用。</p>
<p>jsonp.html页面代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></div><div class="line">    <span class="keyword">var</span> localHandler = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">        alert(<span class="string">'我是本地函数，可以被跨域的remote.js文件调用，远程js带来的数据是：'</span> + data.result);</div><div class="line">    &#125;;</div><div class="line">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://remoteserver.com/remote.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>remote.js文件代码如下：</p>
<p><code>localHandler({&quot;result&quot;:&quot;我是远程js带来的数据&quot;});</code></p>
<p>运行之后查看结果，页面成功弹出提示窗口，显示本地函数被跨域的远程js调用成功，并且还接收到了远程js带来的数据。</p>
<p>很欣喜，跨域远程获取数据的目的基本实现了，但是又一个问题出现了，我怎么让远程js知道它应该调用的本地函数叫什么名字呢？毕竟是jsonp的服务者都要面对很多服务对象，而这些服务对象各自的本地函数都不相同啊？我们接着往下看。</p>
<p>3、聪明的开发者很容易想到，只要服务端提供的js脚本是动态生成的就行了呗，这样调用者可以传一个参数过去告诉服务端“我想要一段调用XXX函数的js代码，请你返回给我”，于是服务器就可以按照客户端的需求来生成js脚本并响应了。</p>
<p>看jsonp.html页面的代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></div><div class="line">    <span class="comment">// 得到航班信息查询结果后的回调函数</span></div><div class="line">    <span class="keyword">var</span> flightHandler = <span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</div><div class="line">        alert(<span class="string">'你查询的航班结果是：票价 '</span> + data.price + <span class="string">' 元，'</span> + <span class="string">'余票 '</span> + data.tickets + <span class="string">' 张。'</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// 提供jsonp服务的url地址（不管是什么类型的地址，最终生成的返回值都是一段javascript代码）</span></div><div class="line">    <span class="keyword">var</span> url = <span class="string">"http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998&amp;callback=flightHandler"</span>;</div><div class="line">    <span class="comment">// 创建script标签，设置其属性</span></div><div class="line">    <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">'script'</span>);</div><div class="line">    script.setAttribute(<span class="string">'src'</span>, url);</div><div class="line">    <span class="comment">// 把script标签加入head，此时调用开始</span></div><div class="line">    <span class="built_in">document</span>.getElementsByTagName(<span class="string">'head'</span>)[<span class="number">0</span>].appendChild(script); </div><div class="line">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>这次的代码变化比较大，不再直接把远程js文件写死，而是编码实现动态查询，而这也正是jsonp客户端实现的核心部分，本例中的重点也就在于如何完成jsonp调用的全过程。</p>
<p>我们看到调用的url中传递了一个code参数，告诉服务器我要查的是CA1998次航班的信息，而callback参数则告诉服务器，我的本地回调函数叫做flightHandler，所以请把查询结果传入这个函数中进行调用。</p>
<p>OK，服务器很聪明，这个叫做flightResult.aspx的页面生成了一段这样的代码提供给jsonp.html（服务端的实现这里就不演示了，与你选用的语言无关，说到底就是拼接字符串）：</p>
<p><code>flightHandler({
    &quot;code&quot;: &quot;CA1998&quot;,
    &quot;price&quot;: 1780,
    &quot;tickets&quot;: 5
});</code></p>
<p>我们看到，传递给flightHandler函数的是一个json，它描述了航班的基本信息。运行一下页面，成功弹出提示窗口，jsonp的执行全过程顺利完成！</p>
<p>4、到这里为止的话，相信你已经能够理解jsonp的客户端实现原理了吧？剩下的就是如何把代码封装一下，以便于与用户界面交互，从而实现多次和重复调用。</p>
<p>什么？你用的是jQuery，想知道jQuery如何实现jsonp调用？好吧，那我就好人做到底，再给你一段jQuery使用jsonp的代码（我们依然沿用上面那个航班信息查询的例子，假定返回jsonp结果不变）：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Untitled Page<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">jquery.min.js</span>"&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">     <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="javascript"></div><div class="line">    jQuery(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; </div><div class="line">       $.ajax(&#123;</div><div class="line">            <span class="attr">type</span>: <span class="string">"get"</span>,</div><div class="line">            <span class="attr">async</span>: <span class="literal">false</span>,</div><div class="line">            <span class="attr">url</span>: <span class="string">"http://flightQuery.com/jsonp/flightResult.aspx?code=CA1998"</span>,</div><div class="line">            <span class="attr">dataType</span>: <span class="string">"jsonp"</span>,</div><div class="line">            <span class="attr">jsonp</span>: <span class="string">"callback"</span>,<span class="comment">//传递给请求处理程序或页面的，用以获得jsonp回调函数名的参数名(一般默认为:callback)</span></div><div class="line">            jsonpCallback:<span class="string">"flightHandler"</span>,<span class="comment">//自定义的jsonp回调函数名称，默认为jQuery自动生成的随机函数名，也可以写"?"，jQuery会自动为你处理数据</span></div><div class="line">            success: <span class="function"><span class="keyword">function</span>(<span class="params">json</span>)</span>&#123;</div><div class="line">                alert(<span class="string">'您查询到航班信息：票价： '</span> + json.price + <span class="string">' 元，余票： '</span> + json.tickets + <span class="string">' 张。'</span>);</div><div class="line">            &#125;,</div><div class="line">            <span class="attr">error</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">                alert(<span class="string">'fail'</span>);</div><div class="line">            &#125;</div><div class="line">        &#125;);</div><div class="line">    &#125;);</div><div class="line">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"> <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"> <span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<p>是不是有点奇怪？</p>
<p>为什么我这次没有写flightHandler这个函数呢？而且竟然也运行成功了！</p>
<p>哈哈，这就是jQuery的功劳了，jquery在处理jsonp类型的ajax时（还是忍不住吐槽，虽然jquery也把jsonp归入了ajax，但其实它们真的不是一回事儿），自动帮你生成回调函数并把数据取出来供success属性方法来调用，是不是很爽呀？</p>
<p>ajax和jsonp其实本质上是不同的东西。ajax的核心是通过XmlHttpRequest获取非本页内容，而jsonp的核心则是动态添加<script>标签来调用服务器提供的js脚本。</p>
<p>所以说，其实ajax与jsonp的区别不在于是否跨域，ajax通过服务端代理一样可以实现跨域，jsonp本身也不排斥同域的数据的获取。</p>
<p>还有就是，jsonp是一种方式或者说非强制性协议，如同ajax一样，它也不一定非要用json格式来传递数据，如果你愿意，字符串都行，只不过这样不利于用jsonp提供公开服务。</p>
<p>-摘自于  <a href="http://www.cnblogs.com/dowinning/archive/2012/04/19/json-jsonp-jquery.html" title="cnblogs">cnblogs</a></p>
</script></p>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/11/30/JSONP的原理，JSON和JSONP区别，也许你会豁然开朗，含jQuery用例/" data-id="cj3xtejg500014se9y7vx0xjt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-前端开发的历史和趋势" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/11/25/前端开发的历史和趋势/" class="article-date">
  <time datetime="2016-11-25T02:28:00.000Z" itemprop="datePublished">2016-11-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/11/25/前端开发的历史和趋势/">前端开发的历史和趋势</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="前端开发的历史和趋势"><a href="#前端开发的历史和趋势" class="headerlink" title="前端开发的历史和趋势"></a>前端开发的历史和趋势</h1><hr>
<h2 id="什么是前端"><a href="#什么是前端" class="headerlink" title="什么是前端"></a>什么是前端</h2><ul>
<li>前端：针对浏览器的开发，代码在浏览器运行</li>
<li>后端：针对服务器的开发，代码在服务器运行</li>
</ul>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/frontend.png" alt="前后端"></p>
<hr>
<h2 id="前后端不分的时代"><a href="#前后端不分的时代" class="headerlink" title="前后端不分的时代"></a>前后端不分的时代</h2><p>互联网发展的早期，前后端开发是一体的，前端代码是后端代码的一部分。</p>
<ol>
<li>后端收到浏览器的请求</li>
<li>生成静态页面</li>
<li>发送到浏览器</li>
</ol>
<hr>
<h2 id="后端-MVC-的开发模式"><a href="#后端-MVC-的开发模式" class="headerlink" title="后端 MVC 的开发模式"></a>后端 MVC 的开发模式</h2><p>那时的网站开发，采用的是后端 MVC 模式。</p>
<ul>
<li>Model（模型层）：提供/保存数据</li>
<li>Controller（控制层）：数据处理，实现业务逻辑</li>
<li>View（视图层）：展示数据，提供用户界面</li>
</ul>
<p>前端只是后端 MVC 的 V。</p>
<hr>
<p>以 PHP 框架 Laravel 为例。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/laravel-mvc.png" alt="后端 MVC 的开发模式"></p>
<hr>
<h2 id="前端工程师的角色"><a href="#前端工程师的角色" class="headerlink" title="前端工程师的角色"></a>前端工程师的角色</h2><p>那时的前端工程师，实际上是模板工程师，负责编写页面模板。</p>
<p>后端代码读取模板，替换变量，渲染出页面。</p>
<hr>
<h2 id="典型的-PHP-模板"><a href="#典型的-PHP-模板" class="headerlink" title="典型的 PHP 模板"></a>典型的 PHP 模板</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;html&gt;</div><div class="line">  &lt;head&gt;&lt;title&gt;Car &#123;&#123; $car-&gt;id &#125;&#125;&lt;/title&gt;&lt;/head&gt;</div><div class="line">  &lt;body&gt;</div><div class="line">    &lt;h1&gt;Car &#123;&#123; $car-&gt;id &#125;&#125;&lt;/h1&gt;</div><div class="line">    &lt;ul&gt;</div><div class="line">      &lt;li&gt;Make: &#123;&#123; $car-&gt;make &#125;&#125;&lt;/li&gt;</div><div class="line">      &lt;li&gt;Model: &#123;&#123; $car-&gt;model &#125;&#125;&lt;/li&gt;</div><div class="line">      &lt;li&gt;Produced on: &#123;&#123; $car-&gt;produced_on &#125;&#125;&lt;/li&gt;</div><div class="line">    &lt;/ul&gt;</div><div class="line">  &lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2><p>Ajax 技术诞生，改变了一切。</p>
<ul>
<li>2004年：Gmail</li>
<li>2005年：Google 地图</li>
</ul>
<p>前端不再是后端的模板，可以独立得到各种数据。</p>
<hr>
<h2 id="Web-2-0"><a href="#Web-2-0" class="headerlink" title="Web 2.0"></a>Web 2.0</h2><p>Ajax 技术促成了 Web 2.0 的诞生。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/web20.gif" alt=""></p>
<ul>
<li>Web 1.0：静态网页，纯内容展示</li>
<li>Web 2.0：动态网页，富交互，前端数据处理</li>
</ul>
<p>从那时起，前端变得复杂了，对前端工程师的要求越来越高。</p>
<hr>
<h2 id="前端-MVC-框架"><a href="#前端-MVC-框架" class="headerlink" title="前端 MVC 框架"></a>前端 MVC 框架</h2><p>前端通过 Ajax 得到数据，因此也有了处理数据的需求。</p>
<p>前端代码变得也需要保存数据、处理数据、生成视图，这导致了前端 MVC 框架的诞生。</p>
<ul>
<li>2010年，Backbone.js</li>
</ul>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/backbone.png" alt=""></p>
<hr>
<h2 id="Backbone-js"><a href="#Backbone-js" class="headerlink" title="Backbone.js"></a>Backbone.js</h2><p>Backbone 将前端代码分成两个基本部分。</p>
<ul>
<li>Model：管理数据</li>
<li>View：数据的展现</li>
</ul>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/backbone-model-view.png" alt="Backbone 将前端代码分成两个基本部分"></p>
<hr>
<h2 id="前端-Controller"><a href="#前端-Controller" class="headerlink" title="前端 Controller"></a>前端 Controller</h2><p>Backbone 只有 M 和 V，没有 C。因为，前端 Controller 与后端不同。</p>
<ul>
<li>不需要，也不应该处理业务逻辑</li>
<li>只需要处理 UI 逻辑，响应用户的一举一动</li>
</ul>
<p>所以，前端 Controller 相对比较简单。Backbone 没有 C，只用事件来处理 UI 逻辑。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> AppView = Backbone.View.extend(&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  events: &#123;</div><div class="line">    <span class="string">"keypress #new-todo"</span>:  <span class="string">"createOnEnter"</span>,</div><div class="line">    <span class="string">"click #clear-completed"</span>: <span class="string">"clearCompleted"</span>,</div><div class="line">    <span class="string">"click #toggle-all"</span>: <span class="string">"toggleAllComplete"</span></div><div class="line">  &#125;,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Router"><a href="#Router" class="headerlink" title="Router"></a>Router</h2><p>前端还有一种天然的方法，可以切换视图，那就是 URL。</p>
<p>通过 URL 切换视图，这就是 Router（路由）的作用。以 Backbone 为例。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/backbone-routing.png" alt="Router"></p>
<hr>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">App.Router = Backbone.Router.extend(&#123;</div><div class="line">  <span class="attr">routes</span>: &#123;</div><div class="line">    <span class="string">''</span>: <span class="string">'index'</span>,</div><div class="line">    <span class="string">'show'</span>: <span class="string">'show'</span></div><div class="line">    &#125;,</div><div class="line">  <span class="attr">index</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    $(<span class="built_in">document</span>.body).append(<span class="string">"调用了 Index 路由"</span>);</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">show</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    $(<span class="built_in">document</span>.body).append(<span class="string">"调用了 Show 路由"</span>);</div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<hr>
<h2 id="示例：Backbone-Router"><a href="#示例：Backbone-Router" class="headerlink" title="示例：Backbone Router"></a>示例：Backbone Router</h2><p>打开<code>demos/backbone-demo/index.html</code>，按照<a href="https://github.com/ruanyf/jstraining/blob/master/demos/README.md#backbone" target="_blank" rel="external">《操作说明》</a>，查看示例。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/backbone-demo.png" alt="Backbone Router"></p>
<hr>
<h2 id="MVVM-模式"><a href="#MVVM-模式" class="headerlink" title="MVVM 模式"></a>MVVM 模式</h2><p>另一些框架提出 MVVM 模式，用 View Model 代替 Controller。</p>
<ul>
<li>Model</li>
<li>View</li>
<li>View-Model：简化的 Controller，唯一作用就是为 View 提供处理好的数据，不含其他逻辑。</li>
</ul>
<p>本质：view 绑定 view-model，视图与数据模型强耦合。数据的变化实时反映在 view 上，不需要手动处理。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/mvvm.png" alt="MVVM 模式"></p>
<hr>
<h2 id="SPA"><a href="#SPA" class="headerlink" title="SPA"></a>SPA</h2><p>前端可以做到：</p>
<blockquote>
<ul>
<li>读写数据</li>
<li>切换视图</li>
<li>用户交互</li>
</ul>
</blockquote>
<p>这意味着，网页其实是一个应用程序。</p>
<blockquote>
<p>SPA = Single-page application</p>
</blockquote>
<p>2010年后，前端工程师从开发页面，变成了开发”前端应用“（跑在浏览器里面的应用程序）。</p>
<hr>
<h2 id="Angular"><a href="#Angular" class="headerlink" title="Angular"></a>Angular</h2><p>Google 公司推出的 Angular 是最流行的 MVVM 前端框架。</p>
<p>它的风格属于 HTML 语言的增强，核心概念是双向绑定。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/angular.png" alt="Google 公司推出的 Angular 是最流行的 MVVM 前端框架"></p>
<hr>
<h2 id="示例：Angular-的双向绑定"><a href="#示例：Angular-的双向绑定" class="headerlink" title="示例：Angular 的双向绑定"></a>示例：Angular 的双向绑定</h2><p>浏览器打开<code>demos/angular-demo/index.html</code>，可以看到一个输入框。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/angular-demo.png" alt="示例：Angular 的双向绑定"></p>
<hr>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;div ng-app=<span class="string">""</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></div><div class="line">    姓名 :</div><div class="line">    <span class="tag">&lt;<span class="name">input</span></span></div><div class="line">      <span class="attr">type</span>=<span class="string">"text"</span></div><div class="line">      <span class="attr">ng-model</span>=<span class="string">"name"</span></div><div class="line">      <span class="attr">placeholder</span>=<span class="string">"在这里输入您的大名"</span></div><div class="line">    &gt;</div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>你好，&#123;&#123;name&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h2><p>Vue.js 是现在很热门的一种前端 MVVM 框架。</p>
<p>它的基本思想与 Angular 类似，但是用法更简单，而且引入了响应式编程的概念。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/vue-logo.png" alt="Vue.js 是现在很热门的一种前端 MVVM 框架"></p>
<hr>
<h2 id="示例：Vue-的双向绑定"><a href="#示例：Vue-的双向绑定" class="headerlink" title="示例：Vue 的双向绑定"></a>示例：Vue 的双向绑定</h2><p>Vue 的模板与数据，是双向绑定的。</p>
<p>打开<code>demos/vue-demo/index1.html</code>，按照<a href="https://github.com/ruanyf/jstraining/blob/master/demos/README.md#vue" target="_blank" rel="external">《操作说明》</a>，查看示例。</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/vue-demo.png" alt="Vue 的模板与数据，是双向绑定的"></p>
<hr>
<p>HTML 代码</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"journal"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"message"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p>JS 代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> journal = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#journal'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">message</span>: <span class="string">'Your first entry'</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<hr>
<h2 id="前后端分离"><a href="#前后端分离" class="headerlink" title="前后端分离"></a>前后端分离</h2><ul>
<li>Ajax -&gt; 前端应用兴起</li>
<li>智能手机 -&gt; 多终端支持</li>
</ul>
<p>这两个原因，导致前端开发方式发生根本的变化。</p>
<p>前端不再是后端 MVC 中的 V，而是单独的一层。</p>
<hr>
<h2 id="REST-接口"><a href="#REST-接口" class="headerlink" title="REST 接口"></a>REST 接口</h2><p>前后端分离以后，它们之间通过接口通信。</p>
<p>后端暴露出接口，前端消费后端提供的数据。</p>
<p>后端接口一般是 REST 形式，前后端的通信协议一般是 HTTP。</p>
<hr>
<h2 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h2><p>2009年，Node 项目诞生，它是服务器上的 JavaScript 运行环境。</p>
<p>Node = JavaScript + 操作系统 API</p>
<p><img src="https://github.com/ruanyf/jstraining/raw/master/docs/images/node-logo.png" alt="服务器上的 JavaScript 运行环境"></p>
<hr>
<h2 id="Node-的意义"><a href="#Node-的意义" class="headerlink" title="Node 的意义"></a>Node 的意义</h2><ul>
<li>JavaScript 成为服务器脚本语言，与 Python 和 Ruby 一样</li>
<li>JavaScript 成为唯一的浏览器和服务器都支持的语言</li>
<li>前端工程师可以编写后端程序了</li>
</ul>
<hr>
<h2 id="前端开发模式的根本改变"><a href="#前端开发模式的根本改变" class="headerlink" title="前端开发模式的根本改变"></a>前端开发模式的根本改变</h2><ul>
<li>Node 环境下开发</li>
<li>大量使用服务器端工具</li>
<li>引入持续集成等软件工程的标准流程</li>
<li>开发完成后，编译成浏览器可以运行的脚本，放上 CDN</li>
</ul>
<hr>
<h2 id="全栈工程师"><a href="#全栈工程师" class="headerlink" title="全栈工程师"></a>全栈工程师</h2><p>前端工程师正在转变为全栈工程师</p>
<ul>
<li>一个人负责开发前端和后端</li>
<li>从数据库到 UI 的所有开发</li>
</ul>
<hr>
<h2 id="全栈技能"><a href="#全栈技能" class="headerlink" title="全栈技能"></a>全栈技能</h2><p>怎样才能称为全栈工程师？</p>
<ul>
<li>传统前端技能：HTML、JavaScript、CSS</li>
<li>一门后端语言</li>
<li>移动端开发：iOS / Android / HTML5</li>
<li>其他技能：数据库、HTTP 等等</li>
</ul>
<hr>
<h2 id="软件行业的发展动力"><a href="#软件行业的发展动力" class="headerlink" title="软件行业的发展动力"></a>软件行业的发展动力</h2><p>历史演变：前后端不分 -&gt; 前后端分离 -&gt; 全栈工程师</p>
<p>动力：更加产业化、大规模地生产软件</p>
<ul>
<li>效率更高</li>
<li>成本更低</li>
</ul>
<p>通用性好、能够快速产出的技术最终会赢，单个程序员的生产力要求越来越高。</p>
<hr>
<h2 id="H5-就是一个最好的例子"><a href="#H5-就是一个最好的例子" class="headerlink" title="H5 就是一个最好的例子"></a>H5 就是一个最好的例子</h2><p>为什么 H5 技术会赢得移动端？</p>
<ul>
<li>开发速度快：Native 需要重新编译才能看到结果，H5 是即时输出</li>
<li>开发成本低：Native 需要两个开发团队，H5 只要一个</li>
<li>快速发布：安卓 Native 新版本需要24小时，iOS 需要 3 ～ 4 天，H5 可以随时更新</li>
</ul>
<hr>
<h2 id="未来软件的特点"><a href="#未来软件的特点" class="headerlink" title="未来软件的特点"></a>未来软件的特点</h2><ul>
<li>联网</li>
<li>高并发</li>
<li>分布式</li>
<li>跨终端</li>
</ul>
<p>现在基于 Web 的前端技术，将演变为未来所有软件的通用的 GUI 解决方案。</p>
<hr>
<h2 id="未来只有两种软件工程师"><a href="#未来只有两种软件工程师" class="headerlink" title="未来只有两种软件工程师"></a>未来只有两种软件工程师</h2><ul>
<li>端工程师<ul>
<li>手机端</li>
<li>PC 端</li>
<li>TV 端</li>
<li>VR 端</li>
<li>……</li>
</ul>
</li>
<li>云工程师</li>
</ul>
<p>-摘自于  <a href="https://github.com/ruanyf/jstraining/blob/master/docs/history.md" title="阮一峰 博客" target="_blank" rel="external">阮一峰 博客</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/11/25/前端开发的历史和趋势/" data-id="cj3xtejhd000w4se9b28snrg6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript-node-js-mongo/">javascript node.js mongo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript-node-js-redis/">javascript node.js redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/css/" style="font-size: 15px;">css</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/javascript-node-js-mongo/" style="font-size: 10px;">javascript node.js mongo</a> <a href="/tags/javascript-node-js-redis/" style="font-size: 10px;">javascript node.js redis</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/15/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/02/08/js-中continue、break、return的区别/">js 中continue、break、return的区别</a>
          </li>
        
          <li>
            <a href="/2017/02/06/js查找字符串中出现最多的以及个数/">js查找字符串中出现最多的以及个数</a>
          </li>
        
          <li>
            <a href="/2017/01/23/JavaScript基本数据类型和引用类型/">JavaScript基本数据类型和引用类型</a>
          </li>
        
          <li>
            <a href="/2017/01/23/JavaScript作用域、以及数据类型/">JavaScript作用域、以及数据类型</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>